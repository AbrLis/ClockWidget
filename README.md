# Clock Widget App

## Описание
Clock Widget App — это десктопное приложение-виджет для Windows, отображающее текущее время в виде полупрозрачного оверлея на рабочем столе. Приложение позволяет настраивать внешний вид и поведение виджета через удобный интерфейс настроек.

## Основные возможности
- Отображение текущего времени в двух режимах:
  - Аналоговые часы с настраиваемым размером и стилем
  - Цифровые часы в формате ЧЧ:ММ:СС
- Настраиваемая прозрачность фона и текста
- Регулируемый размер шрифта для цифровых часов
- Настраиваемый размер аналоговых часов
- Возможность включения/отключения отображения секунд
- Сохранение пользовательских настроек между запусками
- Возможность перемещения виджетов по рабочему столу
- Независимое позиционирование аналоговых и цифровых часов
- Воспроизведение звуковых сигналов (опционально)

## Запуск проекта

### Через командную строку
Из корневой директории проекта:
```bash
# Используя скрипт
.\run.ps1

# Или напрямую
dotnet run --project ClockWidgetApp
```

## Технические детали
### Структура проекта
```
ClockWidgetApp/              # Корневая директория
├── ClockWidgetApp.sln      # Файл решения
├── README.md               # Документация
├── run.ps1                 # Скрипт запуска
├── run-debug.ps1           # Скрипт запуска с отладкой
├── build.ps1               # Скрипт сборки
├── publish-release.ps1     # Скрипт публикации релиза
└── ClockWidgetApp/         # Директория проекта
    ├── Models/             # Модели данных и классы настроек
    │   ├── WidgetSettings.cs      # Настройки виджета
    │   └── ClockTick.cs           # Модель тика часов
    ├── ViewModels/         # Модели представления (MVVM)
    │   ├── MainWindowViewModel.cs                # Основная модель представления
    │   ├── MainWindowViewModel.Properties.cs     # Свойства основной модели
    │   ├── MainWindowViewModel.Settings.cs       # Работа с настройками
    │   ├── MainWindowViewModel.Windows.cs        # Работа с окнами
    │   ├── AnalogClockViewModel.cs               # Модель аналоговых часов
    │   ├── SettingsWindowViewModel.cs            # Модель окна настроек
    │   └── ISettingsViewModel.cs                 # Интерфейс для ViewModel настроек
    ├── Views/                # Представления (XAML)
    │   ├── MainWindow.xaml           # Главное окно
    │   ├── MainWindow.xaml.cs        # Логика главного окна
    │   ├── AnalogClockWindow.xaml    # Окно аналоговых часов
    │   ├── AnalogClockWindow.xaml.cs # Логика окна аналоговых часов
    │   ├── SettingsWindow.xaml       # Окно настроек
    │   └── SettingsWindow.xaml.cs    # Логика окна настроек
    ├── Services/             # Сервисы
    │   ├── TimeService.cs           # Сервис времени
    │   ├── SettingsService.cs       # Сервис настроек
    │   ├── LoggingService.cs        # Сервис логирования
    │   └── SoundService.cs          # Сервис звуков
    ├── Helpers/              # Вспомогательные классы
    │   ├── Constants.cs                # Константы приложения
    │   ├── AnalogClockConstants.cs     # Константы аналоговых часов
    │   ├── WindowPositionHelper.cs     # Помощник позиционирования окон
    │   └── CenterDotPositionConverter.cs # Конвертер для центра аналоговых часов
    ├── Resources/            # Ресурсы приложения
    │   ├── Icons/                    # Иконки приложения
    │   │   ├── app.ico
    │   │   ├── app_ico_16.ico
    │   │   ├── app_ico_32.ico
    │   │   ├── app_ico_64.ico
    │   │   ├── app_ico_128.ico
    │   │   └── app_ico_256.ico
    │   └── Sounds/                   # Звуковые файлы для сигналов
    │       ├── 1.mp3 ... 12.mp3
    ├── App.xaml                # Точка входа приложения (XAML)
    ├── App.xaml.cs             # Логика приложения
    └── AssemblyInfo.cs         # Информация о сборке
```

### Используемые технологии
- .NET 9.0
- WPF (Windows Presentation Foundation)
- MVVM архитектура
- JSON для хранения настроек

### Отображение времени
- Формат с секундами: ЧЧ:ММ:СС
- Формат без секунд: ЧЧ:ММ
- Возможность включения/отключения отображения секунд

### Сборка проекта со всеми зависимостями в один файл
Для сборки проекта в релиз достаточно запустить скрипт `publish-release.ps1` из корневой директории:
```bash
.\publish-release.ps1
```

Скрипт выполнит очистку предыдущих сборок, соберет проект и удалит лишние файлы, оставив только папку `publish` с итоговым билдом.

Файл будет находиться в папке `bin/Release/`

### Расположение файлов настроек
Приложение хранит пользовательские настройки в следующей директории:
```
%APPDATA%\Roaming\ClockWidget\logs\
```

Здесь сохраняются:
- Файл настроек приложения (`settings.json`)

## Логирование

Приложение использует Serilog для логирования. Логи записываются в файл `logs/clock-widget.log`.

### Настройка уровня логирования

Уровень логирования можно настроить через переменную окружения `FILE_LOG_LEVELS`:

```powershell
# Включить отладочные сообщения
$env:FILE_LOG_LEVELS="DEBUG"
.\ClockWidgetApp.exe

# Или только ошибки
$env:FILE_LOG_LEVELS="ERROR"
.\ClockWidgetApp.exe
```

Доступные уровни: `VERBOSE`, `DEBUG`, `INFORMATION`, `WARNING`, `ERROR`, `FATAL`

По умолчанию логируются сообщения уровня WARNING и выше.

## Лицензия
MIT License
