# Clock Widget App

## Описание
Clock Widget App - это десктопное приложение-виджет для Windows, отображающее текущее время в виде полупрозрачного оверлея на рабочем столе. Приложение позволяет настраивать внешний вид и поведение виджета через удобный интерфейс настроек.

## Основные возможности
- Отображение текущего времени в двух режимах:
  - Аналоговые часы с настраиваемым размером и стилем
  - Цифровые часы в формате ЧЧ:ММ:СС
- Настраиваемая прозрачность фона и текста
- Регулируемый размер шрифта для цифровых часов
- Настраиваемый размер аналоговых часов
- Возможность включения/отключения отображения секунд
- Сохранение пользовательских настроек между запусками
- Возможность перемещения виджетов по рабочему столу
- Независимое позиционирование аналоговых и цифровых часов

## Запуск проекта

### Через командную строку
Из корневой директории проекта:
```bash
# Используя скрипт
.\run.ps1

# Или напрямую
dotnet run --project ClockWidgetApp
```

## Технические детали
### Структура проекта
```
ClockWidgetApp/              # Корневая директория
├── ClockWidgetApp.sln      # Файл решения
├── README.md              # Документация
├── run.ps1               # Скрипт запуска
├── run-debug.ps1         # Скрипт запуска с отладкой
├── build.ps1             # Скрипт сборки
├── publish-release.ps1   # Скрипт публикации релиза
└── ClockWidgetApp/        # Директория проекта
    ├── Models/           # Модели данных и классы настроек
    │   ├── WidgetSettings.cs    # Настройки виджета
    │   └── ClockSettings.cs     # Настройки часов
    ├── ViewModels/       # Модели представления (MVVM)
    │   ├── MainViewModel.cs     # Основная модель представления
    │   ├── AnalogClockViewModel.cs  # Модель аналоговых часов
    │   └── DigitalClockViewModel.cs # Модель цифровых часов
    ├── Views/            # Представления (XAML)
    │   ├── MainWindow.xaml      # Главное окно
    │   ├── AnalogClockWindow.xaml  # Окно аналоговых часов
    │   ├── DigitalClockWindow.xaml # Окно цифровых часов
    │   └── SettingsWindow.xaml     # Окно настроек
    ├── Services/         # Сервисы
    │   ├── TimeService.cs       # Сервис времени
    │   ├── SettingsService.cs   # Сервис настроек
    │   └── LoggingService.cs    # Сервис логирования
    ├── Helpers/          # Вспомогательные классы
    │   ├── Constants.cs         # Константы приложения
    │   └── DebugHelper.cs       # Помощник отладки
    ├── Resources/        # Ресурсы приложения
    │   └── Styles/             # Стили и шаблоны
    └── App.xaml          # Точка входа приложения
```

### Используемые технологии
- .NET 9.0
- WPF (Windows Presentation Foundation)
- MVVM архитектура
- JSON для хранения настроек

### Отображение времени
- Формат с секундами: ЧЧ:ММ:СС
- Формат без секунд: ЧЧ:ММ
- Возможность включения/отключения отображения секунд

### Сборка проекта со всеми зависимостями в один файл
Для сборки проекта в релиз достаточно запустить скрипт `publish-release.ps1` из корневой директории:
```bash
.\publish-release.ps1
```

Скрипт выполнит очистку предыдущих сборок, соберет проект и удалит лишние файлы, оставив только папку `publish` с итоговым билдом.

Файл будет находиться в папке `bin/Release/`

### Расположение файлов настроек
Приложение хранит пользовательские настройки в следующей директории:
```
%APPDATA%\Roaming\ClockWidget\
```

Здесь сохраняются:
- Файл настроек приложения (`settings.json`)

### Логирование и отладка
Приложение поддерживает гибкую настройку логирования через переменные окружения. Для запуска в режиме отладки используйте скрипт `run-debug.ps1`:

```powershell
.\run-debug.ps1
```

#### Переменные окружения для логирования
1. `ASPNETCORE_ENVIRONMENT` - определяет, будет ли включено логирование в файл
   - `Development` - логирование в файл включено
   - любое другое значение - логирование в файл отключено

2. `CONSOLE_LOG_LEVEL` - уровень логирования для консоли
   Доступные уровни (от самого подробного к самому критичному):
   - `TRACE` (или `VERBOSE`)
   - `DEBUG`
   - `INFO`
   - `WARN`
   - `ERROR`
   - `FATAL`

3. `FILE_LOG_LEVELS` - уровни логирования для файла (можно указать несколько через запятую)
   Примеры:
   ```powershell
   # Только предупреждения и ошибки
   $env:FILE_LOG_LEVELS = "WARN,ERROR"
   
   # Отладочные сообщения, предупреждения и ошибки
   $env:FILE_LOG_LEVELS = "DEBUG,WARN,ERROR"
   
   # Все уровни логирования
   $env:FILE_LOG_LEVELS = "TRACE,DEBUG,INFO,WARN,ERROR,FATAL"
   ```

#### Расположение логов
Файлы логов сохраняются в директории:
```
%APPDATA%\Roaming\ClockWidget\logs\
```

Имя файла лога: `clock-widget-YYYYMMDD.log`
- Файлы создаются ежедневно
- Старые файлы сохраняются автоматически
- Максимальный размер файла: 10 МБ
- Максимальное количество файлов: 31 (примерно месяц)

#### Примеры конфигурации
1. Только ошибки в консоль, все сообщения в файл:
   ```powershell
   $env:ASPNETCORE_ENVIRONMENT = "Development"
   $env:CONSOLE_LOG_LEVEL = "ERROR"
   $env:FILE_LOG_LEVELS = "DEBUG,INFO,WARN,ERROR,FATAL"
   ```

2. Предупреждения и ошибки везде:
   ```powershell
   $env:ASPNETCORE_ENVIRONMENT = "Development"
   $env:CONSOLE_LOG_LEVEL = "WARN"
   $env:FILE_LOG_LEVELS = "WARN,ERROR"
   ```

3. Только отладочные сообщения:
   ```powershell
   $env:ASPNETCORE_ENVIRONMENT = "Development"
   $env:CONSOLE_LOG_LEVEL = "DEBUG"
   $env:FILE_LOG_LEVELS = "DEBUG"
   ```

## Лицензия
MIT License
